"use strict";!function(){var i=document.getElementById("msg"),e=localStorage.getItem("clashEditor:config:proxygroup"),t=localStorage.getItem("clashEditor:config:rule"),d=[];if(e&&""!==e){jsyaml.load(e)["Proxy Group"].map(function(e){d.push("".concat(e.name))});var o=[];d.forEach(function(e){o.push("<code>".concat(e,"</code>"))}),document.getElementById("rule-proxygroup-list").innerHTML=o.join("，")}else Modal("这看起来不太正常","Clash Editor 无法读取您的 Proxy Group 配置！<br>3 秒后将会回到 Proxy Group 编辑页面！"),setTimeout(function(){window.location.pathname="/proxygroup"},3500);var s=CodeMirror(document.getElementById("rule-editor"),{lineNumbers:!0,mode:"yaml"});t&&""!==t?s.setValue(t):s.setValue("Rule:\n"),document.getElementById("ce-rule-btn-validate").addEventListener("click",function(){try{var e=jsyaml.load(s.getValue()).Rule,n=["DOMAIN-SUFFIX","DOMAIN-KEYWORD","DOMAIN","IP-CIDR","SRC-IP-CIDR","GEOIP","DST-PORT","SRC-PORT","MATCH","FINAL"],r=d.concat(["DIRECT","REJECT"]);try{var t=!0,o=!1,l=void 0;try{for(var c,u=function(){var e=c.value,t=e.split(",")[0],o=e.split(",")[2];if(!r.some(function(e){return e===o||"MATCH"===t||"FINAL"===t}))throw new Error("Rule 中使用了不存在的 Proxy Group");if(!n.some(function(e){return e===t}))throw new Error("Clash Editor 不可辨识的匹配");setLS("clashEditor:config:rule",s.getValue()),i.innerHTML='<span class="text-success">Rule 检查通过</span>',document.getElementById("ce-rule-btn-continue").classList.remove("disabled"),document.getElementById("ce-rule-btn-continue").removeAttribute("disabled"),document.getElementById("ce-rule-btn-continue").setAttribute("href","/finish")},a=e[Symbol.iterator]();!(t=(c=a.next()).done);t=!0)u()}catch(e){o=!0,l=e}finally{try{t||null==a.return||a.return()}finally{if(o)throw l}}}catch(e){Modal("您的 Rule 不符合要求！","<p>报错信息如下所示：</p>\n                    <p><code>".concat(e,"</code></p>"))}}catch(e){Modal("这看起来不太正常","<p>Clash Editor 似乎不能解析您提交的 YAML 内容</p>\n                <p>报错信息如下所示：</p>\n                <p><code>".concat(e,"</code></p>\n                <p>如果您认为这不是您的问题，请在 Clash Editor 的 GitHub 上提交一条 issue，并在 issue 中附上报错信息以供调试</p>"))}})}();